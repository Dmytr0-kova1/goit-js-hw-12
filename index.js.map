{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios, { Axios } from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"46814382-75c1b20cf6e14c25ef5bdd9a6\";\n\nexport default async function fetchData(query, page) {\n    const { data } = await axios(`${BASE_URL}`, {\n        params: {\n            key: API_KEY,\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page: 15\n        }\n    })\n    return data;  \n}\n\n\n\n","export default function createMarkup(images) {   \n    return images.map( ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `<div class=\"gallery\">\n        <a class=\"photo-link\" href=\"${largeImageURL}\">\n                <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags} width=\"360\">\n        </a>\n        <ul class=\"list-item\">\n           <li class=\"item-text\">\n                <h2 class=\"item-title\">Likes</h2>\n                <p class =\"item-text\">${likes}</p>\n           </li>\n          <li class=\"item-text\">\n                <h2 class=\"item-title\">Views</h2>\n                <p class =\"item-text\">${views}</p>\n          </li>\n         <li class=\"item-text\">\n                <h2 class=\"item-title\">Comments</h2>\n                <p class =\"item-text\">${comments}</p>\n         </li>\n         <li class=\"item-text\">\n                <h2 class=\"item-title\">Downloads</h2>\n                <p class =\"item-text\">${downloads}</p>\n         </li>\n     </ul>\n     </div>\n        `}).join(\"\");\n}","import fetchData from \"./js/pixabay-api\";\nimport createMarkup from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".form-search\");\nconst gallery = document.querySelector(\".js-gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMore = document.querySelector(\".btn-load-more\")\n\nform.addEventListener(\"submit\", querySearch);\nloadMore.addEventListener(\"click\", onLoadMore);\n\nlet lightbox;\nlet currentPage = 1;\nconst perPage = 15;\nconst inputVal = \"\";\n\nfunction querySearch(event) {\n    event.preventDefault();\n    loader.style.display = \"block\";\n    const inputVal = event.target.elements.query.value.trim();\n    currentPage = 1;\n    gallery.innerHTML = \"\";\n\n    if (inputVal === \"\") {\n          iziToast.show({\n            title: \"Error\",\n            message:  \"Sorry, you need to enter data for the request. Please try again!\",\n            position: \"topRight\",\n            color: \"red\"\n          })\n        loader.style.display = \"none\";\n        return;\n    }\n\n    fetchData(inputVal)\n        .then((response) => {\n            if (response.hits.length === 0) {\n                iziToast.show({\n            title: \"Error\",\n            message:  \"Sorry, there are no images matching your search query. Please try again!\",\n            position: \"topRight\",\n            color: \"red\"\n                })\n                return;\n            }\n            \n            gallery.innerHTML = createMarkup(response.hits);\n            loader.style.display = \"none\";\n            loadMore.classList.remove(\"visually-hidden\");\n\n            if (lightbox) {\n                lightbox.refresh();\n            } else {\n                lightbox = new SimpleLightbox(\".gallery a\"); \n            }            \n        })\n        .catch(error => {\n            console.log(error);\n\n            iziToast.show({\n                title: \"Error\",\n                message:  \"Sorry, there are no images matching your search query. Please try again!\",\n                position: \"topRight\",\n                color: \"red\"\n            })\n        })\n}\n\nasync function onLoadMore() {\n    currentPage++;\n    loadMore.disabled = true;\n    loadMore.style.display = \"none\";\n    loader.style.display = \"block\";\n\n    try {\n        const data = await fetchData(inputVal, currentPage);\n        gallery.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits));\n\n       let totalPages = Math.ceil(data.totalHits / perPage);\n\n        if (data.hits.length === 0 || currentPage >= totalPages) {\n            loadMore.classList.add(\"visually-hidden\");\n            iziToast.show({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\",\n                color: \"blue\"\n            })\n        }\n        const card = document.querySelector(\".gallery\");\n        const cardHeight = card.getBoundingClientRect().height;\n        \n        window.scrollBy({\n            left: 0,\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        })\n    } catch (error) {\n        console.log(error);\n    } finally {\n        loader.style.display = \"none\";\n        loadMore.style.display = \"block\";\n        loadMore.disabled = false;\n    }\n}\n\n\n"],"names":["BASE_URL","API_KEY","fetchData","query","page","data","axios","createMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","gallery","loader","loadMore","querySearch","onLoadMore","lightbox","currentPage","perPage","inputVal","event","iziToast","response","SimpleLightbox","error","totalPages","cardHeight"],"mappings":"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"}
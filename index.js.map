{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios, { Axios } from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"46814382-75c1b20cf6e14c25ef5bdd9a6\";\n\nexport default async function fetchData(query, page, perPage) {\n    const { data } = await axios.get(`${BASE_URL}`, {\n        params: {\n            key: API_KEY,\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page: perPage\n        }\n    })\n    return data;  \n}","export default function createMarkup(images) {   \n    return images.map( ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `<div class=\"gallery\">\n        <a class=\"photo-link\" href=\"${largeImageURL}\">\n                <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags} width=\"360\">\n        </a>\n        <ul class=\"list-item\">\n           <li class=\"item-text\">\n                <h2 class=\"item-title\">Likes</h2>\n                <p class =\"item-text\">${likes}</p>\n           </li>\n          <li class=\"item-text\">\n                <h2 class=\"item-title\">Views</h2>\n                <p class =\"item-text\">${views}</p>\n          </li>\n         <li class=\"item-text\">\n                <h2 class=\"item-title\">Comments</h2>\n                <p class =\"item-text\">${comments}</p>\n         </li>\n         <li class=\"item-text\">\n                <h2 class=\"item-title\">Downloads</h2>\n                <p class =\"item-text\">${downloads}</p>\n         </li>\n     </ul>\n     </div>\n        `}).join(\"\");\n}","import fetchData from \"./js/pixabay-api\";\nimport createMarkup from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".form-search\");\nconst gallery = document.querySelector(\".js-gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMore = document.querySelector(\".btn-load-more\")\n\nform.addEventListener(\"submit\", querySearch);\nloadMore.addEventListener(\"click\", () => onLoadMore(form.elements.query.value.trim()));\n\nlet lightbox;\nlet page = 1;\nconst perPage = 15;\n\nasync function querySearch(event) {\n    event.preventDefault();\n    page = 1;\n    loader.style.display = \"block\";\n    gallery.innerHTML = \"\";\n    const query = event.target.elements.query.value.trim();\n    loadMore.classList.add(\"visually-hidden\");\n\n    if (query === \"\") {\n          iziToast.show({\n            title: \"Error\",\n            message:  \"Sorry, you need to enter data for the request. Please try again!\",\n            position: \"topRight\",\n            color: \"red\"\n          })\n        loader.style.display = \"none\";\n        return;\n    }\n\n    await fetchData(query, page, perPage)\n        .then(({ hits }) => {\n            if (hits.length === 0) {\n                iziToast.show({\n            message:  \"Sorry, there are no images matching your search query. Please try again!\",\n            position: \"topRight\",\n            color: \"red\"\n                })\n\n            loader.style.display = \"none\";\n                return;\n            }\n            \n            gallery.insertAdjacentHTML(\"beforeend\", createMarkup(hits));\n            loader.style.display = \"none\";\n            loadMore.classList.remove(\"visually-hidden\");\n\n            if (hits.length < perPage) {\n                loadMore.classList.add(\"visually-hidden\");\n            } else {\n                loadMore.classList.remove(\"visually-hidden\");\n            }\n\n            if (lightbox) {\n                lightbox.refresh();\n            } else {\n                lightbox = new SimpleLightbox(\".gallery a\"); \n            }            \n        })\n        .catch(error => {\n            console.log(error);\n        })\n}\n\nasync function onLoadMore(query) {\n    page++;\n    loadMore.classList.add(\"visually-hidden\");\n    loader.style.display = \"block\";\n\n    try {\n        const { hits, totalHits } = await fetchData(query, page, perPage);\n        gallery.insertAdjacentHTML(\"beforeend\", createMarkup(hits));\n\n        if (lightbox) {\n            lightbox.destroy();\n        }\n        lightbox = new SimpleLightbox(\".gallery a\");\n\n        loadMore.classList.remove(\"visually-hidden\");\n\n        if (page * perPage >= totalHits) {\n            loadMore.classList.add(\"visually-hidden\");\n            iziToast.show({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\",\n                color: \"blue\"\n            })\n        }\n        const card = document.querySelector(\".gallery\");\n        const cardHeight = card.getBoundingClientRect().height;\n        \n        window.scrollBy({\n            left: 0,\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        })\n    } catch (error) {\n        console.log(error);\n    } finally {\n        loader.style.display = \"none\";\n    }\n}\n\n\n"],"names":["BASE_URL","API_KEY","fetchData","query","page","perPage","data","axios","createMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","gallery","loader","loadMore","querySearch","onLoadMore","lightbox","event","iziToast","hits","SimpleLightbox","error","totalHits","cardHeight"],"mappings":"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"}